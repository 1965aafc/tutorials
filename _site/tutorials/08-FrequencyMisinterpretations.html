<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>08-FrequencyMisinterpretations</title>
  <meta name="description" content="How Frequency Representations Go Wrong">

  <link rel="canonical" href="http://localhost:4000//tutorials/08-FrequencyMisinterpretations.html">
  <link rel="alternate" type="application/rss+xml" title="VoytekLab Tutorials" href="http://localhost:4000//feed.xml">

  <meta property="og:url"         content="http://localhost:4000//tutorials/08-FrequencyMisinterpretations.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="08-FrequencyMisinterpretations" />
<meta property="og:description" content="How Frequency Representations Go Wrong" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://localhost:4000//tutorials/08-FrequencyMisinterpretations.html",
  "headline":
    "08-FrequencyMisinterpretations",
  "datePublished":
    "2018-10-26T23:55:44-07:00",
  "dateModified":
    "2018-10-26T23:55:44-07:00",
  "description":
    "How Frequency Representations Go Wrong",
  "author": {
    "@type": "Person",
    "name": "VoytekLab"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4000/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://localhost:4000/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  console.log(url)
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return jQuery.param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = $("a").each(function() {
    var href = this.href;
    // If the link is an internal link...
    if (href.search("http://localhost:4000") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + jQuery.param(params);
      this.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = $("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = 'binder';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("https://mybinder.org", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          $("a.interact-button").after($('<div class="interact-context">on ' + hubUrlNoHttp + '</div>'));

      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">VoytekLab Tutorials</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/tutorials/00-Introduction"
        >
          
          Tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/00-Introduction"
                >
                  
                  00-Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/01-ElectrophysiologicalTimeSeries"
                >
                  
                  01-ElectrophysiologicalTimeSeries
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/02-Filtering"
                >
                  
                  02-Filtering
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/03-SpectralMethods"
                >
                  
                  03-SpectralMethods
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/04-EventRelatedPotentials"
                >
                  
                  04-EventRelatedPotentials
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/05-FrequencyInteractions"
                >
                  
                  05-FrequencyInteractions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/06-ColoredNoise"
                >
                  
                  06-ColoredNoise
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/07-CommonMisinterpretations"
                >
                  
                  07-CommonMisinterpretations
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/tutorials/08-FrequencyMisinterpretations"
                >
                  
                  08-FrequencyMisinterpretations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          <!-- INTERACT LINKS -->

    
    
    <div class="buttons">
        <a class="interact-button" href="https://mybinder.org/v2/gh/choldgraf/jupyter-book/master?filepath=content%2Ftutorials%2F08-FrequencyMisinterpretations.ipynb">Interact</a>
    </div>


          <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#default-imports">Default imports</a></li>
  <li><a href="#simple-sinusoids">Simple Sinusoids</a></li>
  <li><a href="#complex-sinusoids">Complex Sinusoids</a></li>
  <li><a href="#non-sinusoids">Non-sinusoids</a></li>
  <li><a href="#load-and-plot-data">Load and plot data</a></li>
</ul>
    </nav>
  </aside>


          <h1 id="how-frequency-representations-go-wrong">How Frequency Representations Go Wrong</h1>

<h5 id="sydney-smith-2018">Sydney Smith 2018</h5>

<p>The information provided in this tutorial is based on the <a href="https://doi.org/10.1016/j.tics.2016.12.008">Cole &amp; Voytek 2017</a> paper <em>Brain Oscillations and the Importance of Waveform Shape</em>.</p>

<p>Many of the techniques used to analyze neural signals, such as the Fourier Transform, filtering, etc., assume that the signals are sinusoidal in nature. These methods are found broadly in the literature and have been used to characterize aspects of the signal like oscillations, bursts, and frequency interactions. This presents a problem. Why? Because neural signals are rarely, if ever, sinusoidal.</p>

<p>In this this tutorial, we will:</p>

<ol>
  <li>
    <p>Differentiate between sinuoids and non-sinusoids</p>
  </li>
  <li>
    <p>Demonstrate non-sinusoidal waveforms in the frequency domain</p>
  </li>
  <li>
    <p>Identify the non-sinusoidal features of neural oscillatons</p>
  </li>
  <li>
    <p>Suggest alternative analysis methods and where to find them</p>
  </li>
</ol>

<h3 id="default-imports">Default imports</h3>

<p>Before we begin, we’ll import useful python libraries and set some standard figure parameters.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s">'retina'</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">figure</span> <span class="o">=</span> <span class="p">{</span><span class="s">'figsize'</span><span class="p">:</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">)}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'figure'</span><span class="p">,</span> <span class="o">**</span><span class="n">figure</span><span class="p">)</span>

<span class="n">font</span> <span class="o">=</span> <span class="p">{</span><span class="s">'family'</span> <span class="p">:</span> <span class="s">'arial'</span><span class="p">,</span>
        <span class="s">'weight'</span> <span class="p">:</span> <span class="s">'regular'</span><span class="p">,</span>
        <span class="s">'size'</span>   <span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="o">**</span><span class="n">font</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="1-sinusoids-vs-non-sinusoids">1. Sinusoids vs Non-sinusoids</h2>

<h3 id="simple-sinusoids">Simple Sinusoids</h3>

<p>Methods in neural signal analysis are based on the assumptions that the signal in question is sinusoidal. A sinusoid is a smooth, periodic oscillation. Let’s generate one now.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c">#sampling frequency</span>
<span class="n">dur</span> <span class="o">=</span> <span class="mi">10</span> <span class="c">#10 seconds of signal</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">7</span> <span class="c">#7 Hz signal</span>
<span class="n">freq2</span> <span class="o">=</span> <span class="mi">130</span> <span class="c">#130 Hz signal</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="c">#times for d</span>
<span class="n">sig1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c">#10 Hz wavelength</span>
<span class="n">sig1</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">sig1</span><span class="p">;</span> <span class="c">#increase the power of signal 1</span>
<span class="c">#sig2 = np.sin(2 *np.pi * freq2 * t) #130 Hz wavelength</span>
<span class="c">#complex_signal = sig1+sig2;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span><span class="n">sig1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">])</span> <span class="c">#plot 0.5 seconds of data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Sinusoidal Signal'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Sinusoidal Signal')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_6_1.png" alt="png" /></p>

<h3 id="complex-sinusoids">Complex Sinusoids</h3>

<p>Adding more than one sinusoid together creates a complex sinusoid.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sig2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">complex_signal</span> <span class="o">=</span> <span class="n">sig1</span><span class="o">+</span><span class="n">sig2</span><span class="p">;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">complex_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Complex Sinusoid'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Complex Sinusoid')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_8_1.png" alt="png" /></p>

<p>Adding enough sinusoids together creates a complex signal that starts to resemble something we might see in a real electrophysiological recording. The following complex signal is composed of four frequencies: 7 Hz, 18 Hz, 80 Hz, and 130 Hz.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">freq3</span> <span class="o">=</span> <span class="mi">18</span> <span class="c">#18 Hz signal</span>
<span class="n">freq4</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">sig3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">sig4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">complex_signal2</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">=</span> <span class="n">sig1</span><span class="o">+</span><span class="n">sig2</span><span class="o">+</span><span class="n">sig3</span><span class="o">+</span><span class="n">sig4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">complex_signal2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'complex signal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'4-Frequency Complex Sinusoid'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'4-Frequency Complex Sinusoid')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_10_1.png" alt="png" /></p>

<h3 id="non-sinusoids">Non-sinusoids</h3>

<p>Now lets see what a non-sinusoidal signal looks like.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>

<span class="n">freq</span> <span class="o">=</span> <span class="mi">10</span> <span class="c">#10 Hz signal</span>
<span class="n">saw_signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sawtooth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">saw_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'sawtooth signal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Sawtooth Signal'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Sawtooth Signal')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_12_1.png" alt="png" /></p>

<p>Notice this waveform is not a smooth oscillation like the sinusoids above. Instead, its shape resembles the serrated edge of a saw. The “sawtooth” wave is an example of a nonsinudoidal waveform. Here are a few more non-sinusoids.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">freq</span> <span class="o">=</span> <span class="mi">20</span> <span class="c">#20Hz </span>
<span class="n">square_signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">square_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'square signal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Square Wave'</span><span class="p">)</span>

<span class="n">triangle_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">sawtooth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">triangle_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Triangle Wave'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Triangle Wave')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_14_1.png" alt="png" /></p>

<h2 id="2-non-sinusoids-in-the-frequency-domain">2. Non-sinusoids in the Frequency Domain</h2>

<p>Now lets see how sinusoids and non-sinusoids compare in the frequency domain. Let’s start with the sawtooth wave. Here’s the frequency spectrum, the first is the Fourier-transformed signal and the second is plotted using Welch’s method.</p>

<p>If you need a refresher on the frequency domain and PSD, check out our <a href="LINK!">tutorial</a>.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate sawtooth signal at 10Hz</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">10</span> 
<span class="n">saw_signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sawtooth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c"># Fourier Transform on the sawtooth</span>
<span class="n">fourier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">saw_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10000</span><span class="p">])</span>
<span class="n">fx_step_size</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">saw_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10000</span><span class="p">])</span>
<span class="n">nyq</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="mi">1024</span>
<span class="n">total_steps</span> <span class="o">=</span> <span class="n">nyq</span><span class="o">/</span><span class="n">fx_step_size</span>
<span class="n">fx_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nyq</span><span class="p">,</span><span class="n">total_steps</span><span class="p">)</span>

<span class="c"># Plot FFT</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fx_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">600</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">600</span><span class="p">])))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'log Power'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Frequency (Hz)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'FFT of Sawtooth signal'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'FFT of Sawtooth signal')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_17_1.png" alt="png" /></p>

<p>Although we can see some clear peaks, that PSD looks a little messy, let’s clean it up and plot it again using the Welch’s method.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Welch's PSD on sawtooth</span>
<span class="n">welch_freq</span><span class="p">,</span><span class="n">pspec</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">saw_signal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">'hanning'</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> 
                          <span class="n">noverlap</span><span class="o">=</span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="s">'linear'</span><span class="p">,</span> <span class="n">return_onesided</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s">'density'</span><span class="p">)</span>
<span class="c"># Plot Welch's</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">welch_freq</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pspec</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="p">])))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'log Power'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Frequency (Hz)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Welch's PSD of sawtooth signal"</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,"Welch's PSD of sawtooth signal")
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_19_1.png" alt="png" /></p>

<p>Wait a minute… Those look weird, right? The sawtooth signal we generated has a frequency of 10Hz. So why are we seeing prominent peaks at 10, 20, 30, 40, 50, 60Hz? Notice that these peaks are appearing at integer multiples of the fundamental 10Hz. These are called harmonics. So why is the spectrum telling us there is power in these harmonics when we know that the only frequency present is 10Hz?</p>

<p>Take a guess.</p>

<p>YES! It’s because the sawtooth signal is non-sinusoidal. The Fourier Transform is specifically meant for sinusoidal waveforms, so <strong>when it’s used on a signal that is not sinusoidal, the math is still treating it like it’s a complex sinusoid instead of a non-sinusoidal signal</strong>. Therefore, we are given the frequencies of the sinusoidal psuedo-components that would create this non-sinusoidal signal.</p>

<p>This creates a problem: the spectrum isn’t representing the reality of the signal. But don’t blame the math! It’s doing exactly what we ask it too. We’re just choosing the wrong method to look at it so <em>of course</em> we’re getting the wrong answer.</p>

<p>However, this hints at an even bigger problem. Sinusoid-based functions are used almost universally in the field of neuroscience. So what happens when the neural signals they’re used to analyze aren’t always sinusoidal?</p>

<p>Just something to think about…</p>

<h2 id="3-non-sinusoidal-features-of-neural-oscillations">3. Non-sinusoidal Features of Neural Oscillations</h2>

<p>Now let’s take a closer look at neural oscillations. What do the waveforms actually look like? We’ll start by loading and plotting some local field potential (LFP) data recorded from a rat hippocampus.</p>

<h3 id="load-and-plot-data">Load and plot data</h3>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Load signal</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">'dat/sample_data_1.npy'</span><span class="p">)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">Fs</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">f_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>

<span class="c"># Plot example signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time (s)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Voltage (uV)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Rat Hippocampal LFP'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Rat Hippocampal LFP')
</code></pre></div></div>

<p><img src="../images/build/tutorials/08-FrequencyMisinterpretations_24_1.png" alt="png" /></p>

<p>Take a closer look at the time series we just plotted. <strong>Notice how the peaks and the troughs of the waveforms aren’t symmetrical for each cycle</strong>. It looks like the peaks of the waveform are much wider and smoother than the sharp, narrow troughs. The waves around 4.4s are a great example of this.</p>

<p>Sinusoids are smooth, symmetrical oscillations. These waveforms aren’t smooth or symmetrical. Therefore, this is probably not a sinusoid.</p>

<p>If neural signals aren’t sinusoidal, the sinusoid-dependent analysis methods like the Fourier transform could potentially give false results, just like it did on the non-sinusoidal sawtooth wave. And if the math gives us bad output, what hope do we have of accurately characterizing the signal?</p>

<p>It’s a tough problem, one that’s still in the works of being solved (like everything in science). Luckily, one thing we can do is learn how to better paramaterize the signal.</p>

<h2 id="4-analyzing-non-sinusoidal-signals">4. Analyzing Non-sinusoidal Signals</h2>

<p>So how do we start to extract information from non-sinusoidal neural data? One option is to stay within the time series and look at waveform shape. Specifically, we can quantify the degree of symmetry within the waveform.</p>

<p>Scott Cole, one of the Voytek Lab’s awesome graduate students, has written an algorithm to do just this. His method, called Cycle-by-cycle, measures the degree of symmetry in each cycle of the waveform. Specifically, it delivers two very important ratios:</p>
<ol>
  <li>Sharpness or <strong>Peak/Trough Symmetry</strong>, defined as a ratio of how much of the waveform is located in the peak compared to the trough.</li>
  <li>Sawtooth-yness or <strong>Rise/Decay Symmetry</strong>, defined as a ratio of how much of the waveform is located in the rising phase of the waveform compared to the decaying phase.</li>
</ol>

<p>For more information, read Scott’s paper <em>Cycle-by-cycle Analysis of Neural Oscillations</em>, <a href="https://www.biorxiv.org/content/biorxiv/early/2018/04/16/302000.full.pdf">preprint</a> now available on bioRxiv.</p>

<p>The algorithm itself, along with a helpful tutorial, is available on the Voytek Lab Github in the repository <a href="https://github.com/voytekresearch/neurodsp">NeuroDSP</a>.</p>

<p>NeuroDSP contains a collection of useful tools for digital signal processing, including filtering, spectral analysis, phase-amplitude coupling, and much more, all with detailed and helpful tutorials that make using it easy. Check it out and happy analyzing!</p>


          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/tutorials/07-CommonMisinterpretations">
      〈 <span class="u-margin-right-tiny"></span> 07-CommonMisinterpretations
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/">
       <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

        </div>
      </main>
    </div>

  </body>
</html>
