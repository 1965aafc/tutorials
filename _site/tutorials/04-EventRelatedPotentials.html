<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>04-EventRelatedPotentials</title>
  <meta name="description" content="Cognitive and Neural Dynamics Lab TutorialsEvent Related Potentials (ERP)">

  <link rel="canonical" href="http://localhost:4000//tutorials/04-EventRelatedPotentials.html">
  <link rel="alternate" type="application/rss+xml" title="VoytekLab Tutorials" href="http://localhost:4000//feed.xml">

  <meta property="og:url"         content="http://localhost:4000//tutorials/04-EventRelatedPotentials.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="04-EventRelatedPotentials" />
<meta property="og:description" content="Cognitive and Neural Dynamics Lab TutorialsEvent Related Potentials (ERP)" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://localhost:4000//tutorials/04-EventRelatedPotentials.html",
  "headline":
    "04-EventRelatedPotentials",
  "datePublished":
    "2018-10-26T23:55:44-07:00",
  "dateModified":
    "2018-10-26T23:55:44-07:00",
  "description":
    "Cognitive and Neural Dynamics Lab TutorialsEvent Related Potentials (ERP)",
  "author": {
    "@type": "Person",
    "name": "VoytekLab"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4000/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://localhost:4000/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  console.log(url)
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return jQuery.param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = $("a").each(function() {
    var href = this.href;
    // If the link is an internal link...
    if (href.search("http://localhost:4000") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + jQuery.param(params);
      this.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = $("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = 'binder';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("https://mybinder.org", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          $("a.interact-button").after($('<div class="interact-context">on ' + hubUrlNoHttp + '</div>'));

      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">VoytekLab Tutorials</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/tutorials/00-Introduction"
        >
          
          Tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/00-Introduction"
                >
                  
                  00-Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/01-ElectrophysiologicalTimeSeries"
                >
                  
                  01-ElectrophysiologicalTimeSeries
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/02-Filtering"
                >
                  
                  02-Filtering
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/03-SpectralMethods"
                >
                  
                  03-SpectralMethods
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/tutorials/04-EventRelatedPotentials"
                >
                  
                  04-EventRelatedPotentials
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/05-FrequencyInteractions"
                >
                  
                  05-FrequencyInteractions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/06-ColoredNoise"
                >
                  
                  06-ColoredNoise
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/07-CommonMisinterpretations"
                >
                  
                  07-CommonMisinterpretations
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/08-FrequencyMisinterpretations"
                >
                  
                  08-FrequencyMisinterpretations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          <!-- INTERACT LINKS -->

    
    
    <div class="buttons">
        <a class="interact-button" href="https://mybinder.org/v2/gh/choldgraf/jupyter-book/master?filepath=content%2Ftutorials%2F04-EventRelatedPotentials.ipynb">Interact</a>
    </div>


          <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#event-related-potentials-erp">Event Related Potentials (ERP)</a></li>
</ul>
    </nav>
  </aside>


          <h1 id="cognitive-and-neural-dynamics-lab-tutorials">Cognitive and Neural Dynamics Lab Tutorials</h1>
<h2 id="event-related-potentials-erp">Event Related Potentials (ERP)</h2>

<h5 id="michael-tran-2018-torben-noto-2015">Michael Tran 2018, Torben Noto 2015</h5>

<p>In this notebook we’re going to talk about how to calculate the <strong>event related potential (ERP)</strong> on some ECoG data.</p>

<p>The basic idea of an ERP is to look at how the electrical activity of a participant’s brain changes when you present a stimulus.</p>

<p>Because the signal is <strong>very</strong> noisy, you will take the average brain activity across a time window of many trials.</p>

<p>Let’s say you are running an experiment where you want to see how people’s brains respond to sentances with expected words (I take coffee with cream and <strong>sugar</strong>) vs. sentences with unexpected words (I take coffee with cream and <strong>dog</strong>)</p>

<p>So we get a participant and put some electrodes on their head.  We show them 10 sentences with expected words and 10 sentences with unexpected words.<br />
This is actually a famous ERP experiment that Marta Kutas, the chair of the CogSci Department here at UCSD, did.</p>

<p>This tutorial will tell you how to analyze the data in an experiment like this in this experiment and calculate a result.</p>

<p>Here’s how we do it:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Loading all of the helpful modules</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#loading ECoG data</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">'emodat.mat'</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">'./'</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">srate</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'srate'</span><span class="p">]</span> <span class="c"># sampling rate</span>
<span class="n">srate</span> <span class="o">=</span> <span class="n">srate</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span> <span class="c"># time series</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"There are "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="s">" samples in this data"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The sampling rate is "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">srate</span><span class="p">))</span>
</code></pre></div></div>

<div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>There are 1476035 samples in this data
The sampling rate is 1017.2533333333334

</code></pre></div></div>

<h4 id="step-1">Step 1:</h4>
<p>Let’s start simple and look at the data surround 1 event</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">event_inds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1034</span><span class="p">,</span> <span class="mi">2133</span><span class="p">,</span> <span class="mi">4681</span><span class="p">,</span> <span class="mi">9960</span><span class="p">,</span> <span class="mi">12574</span><span class="p">]</span> <span class="c">#Time indicies when a stimulus is presented to the subject</span>
<span class="n">this_event</span> <span class="o">=</span> <span class="n">event_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">timewin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span> <span class="c">#500 samples before and 1000 samples after. Remember this: The units here are samples, not milliseconds. </span>
<span class="c">#We sampled at 1017.253 samples per second so we'll looking at about a second and a half of data.</span>


<span class="n">my_ERP</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">this_event</span><span class="o">-</span><span class="n">timewin</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">this_event</span> <span class="o">+</span> <span class="n">timewin</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_ERP</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s">'ERP'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s">'event onset'</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">'ECoG data ~500 ms before and ~1000 ms after an event'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ECoG data ~500 ms before and ~1000 ms after an event

</code></pre></div></div>

<p><img src="../images/build/tutorials/04-EventRelatedPotentials_5_1.png" alt="png" /></p>

<p>This really doesn’t tell us much about what someone’s brain is doing. We have no idea how much of the change in voltage is caused by the <strong>event</strong> compared to <strong>other random ongoing brain activity</strong> and there is no reliability that we will see this in the other stimulus presentations.</p>

<p>We can do better by looking at multiple events 
(and eventually multiple channels and participants) involved in our analysis.</p>

<p>Now let’s do a much more robust method of computing ERP:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Let's look at ERP's of 5 events next to eachother</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">event_inds</span><span class="p">)):</span>
    <span class="n">this_ERP</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">-</span><span class="n">timewin</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">+</span> <span class="n">timewin</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_ERP</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s">'ERP '</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s">'event onset'</span><span class="p">)</span>    
<span class="n">legend</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">my_ERP</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1500,)

</code></pre></div></div>

<p><img src="../images/build/tutorials/04-EventRelatedPotentials_7_1.png" alt="png" /></p>

<p>What a mess.</p>

<p>I don’t know how you could draw any meaningful conclusions from data if we visualize it this way.</p>

<p>Here’s how we’re going to clean up this data matrix to make a basic ERP:</p>
<ol>
  <li>We’ll <strong>normalize</strong> all of the events to the same baseline and</li>
  <li>We’ll calculate the voltage for the <strong>average</strong> trial</li>
</ol>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chan_baselines</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">event_inds</span><span class="p">));</span> <span class="c">#We're going to get a baseline ERP data before we analyze any of the data.</span>
<span class="n">ERP_matrix</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">event_inds</span><span class="p">),</span><span class="n">timewin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">timewin</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="c">#We're making a matrix that will hold all the trials. We will get the mean from this.</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">event_inds</span><span class="p">)):</span>
    <span class="n">chan_baselines</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">+</span> <span class="mi">0</span><span class="p">])</span> 
    <span class="n">ERP_baseline_removed</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">-</span><span class="n">timewin</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">event_inds</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">+</span> <span class="n">timewin</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">chan_baselines</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="c">#subtracting baseline from each trial.    </span>
    <span class="n">ERP_matrix</span><span class="p">[</span><span class="n">event</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">ERP_baseline_removed</span><span class="p">;</span>
    
<span class="n">mean_ERP</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ERP_matrix</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">#taking the mean voltage across trials.</span>
<span class="k">print</span><span class="p">(</span><span class="n">chan_baselines</span><span class="p">)</span> <span class="c">#see why it's important to remove baseline?</span>

<span class="c">#plotting</span>
<span class="n">plot</span><span class="p">(</span><span class="n">mean_ERP</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'ERP'</span><span class="p">);</span>
<span class="n">plot</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s">'event onset'</span><span class="p">);</span>
<span class="n">legend</span><span class="p">()</span>



</code></pre></div></div>

<div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ -5.27431592 -14.45248451 -27.37377517   2.44753003 -22.96190022]

</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x22b0eb627f0&gt;
</code></pre></div></div>

<p><img src="../images/build/tutorials/04-EventRelatedPotentials_9_2.png" alt="png" /></p>

<p>This is just a a basic example of an ERP. This plot represents the average signal across 5 events for one electrode.</p>

<p>A typical ERP has features that are indicitive of cognitive processes (such as the P1, N2 etc.). You don’t see any of those here because this ERP is calculated on sham events. It also looks ‘noisier’ because it is done on ECoG data where the frequency resolution is much higher.</p>

<p>Make sure that you understand every step of the simple introductory code above.</p>

<p>That’s it! In Summary here’s what we learned:</p>
<ol>
  <li>You can look at the time window surrounding a single event or multiple events to see what is going on. By the way, an event in an ERP doesn’t have to be a stimulus presentation. An ERP can be calculated using any timepoints that might be interesting</li>
  <li>If you want an accurate ERP, you have to subtract out the baseline noise</li>
  <li>You can also look at ERP’s as a percent increase from baseline if you want.</li>
  <li>Think hard about what this signal means physiologically and what taking the mean of lots of trials tells you as well. What does it mean that the average amplitudes are higher or lower after an event?</li>
</ol>


          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/tutorials/03-SpectralMethods">
      〈 <span class="u-margin-right-tiny"></span> 03-SpectralMethods
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/tutorials/05-FrequencyInteractions">
      05-FrequencyInteractions <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

        </div>
      </main>
    </div>

  </body>
</html>
