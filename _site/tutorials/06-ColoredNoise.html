<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>06-ColoredNoise</title>
  <meta name="description" content="Colored Noise">

  <link rel="canonical" href="http://localhost:4000//tutorials/06-ColoredNoise.html">
  <link rel="alternate" type="application/rss+xml" title="VoytekLab Tutorials" href="http://localhost:4000//feed.xml">

  <meta property="og:url"         content="http://localhost:4000//tutorials/06-ColoredNoise.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="06-ColoredNoise" />
<meta property="og:description" content="Colored Noise" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://localhost:4000//tutorials/06-ColoredNoise.html",
  "headline":
    "06-ColoredNoise",
  "datePublished":
    "2018-10-26T23:55:44-07:00",
  "dateModified":
    "2018-10-26T23:55:44-07:00",
  "description":
    "Colored Noise",
  "author": {
    "@type": "Person",
    "name": "VoytekLab"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4000/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://localhost:4000/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  console.log(url)
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return jQuery.param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = $("a").each(function() {
    var href = this.href;
    // If the link is an internal link...
    if (href.search("http://localhost:4000") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + jQuery.param(params);
      this.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = $("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = 'binder';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("https://mybinder.org", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          $("a.interact-button").after($('<div class="interact-context">on ' + hubUrlNoHttp + '</div>'));

      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">VoytekLab Tutorials</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/tutorials/00-Introduction"
        >
          
          Tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/00-Introduction"
                >
                  
                  00-Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/01-ElectrophysiologicalTimeSeries"
                >
                  
                  01-ElectrophysiologicalTimeSeries
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/02-Filtering"
                >
                  
                  02-Filtering
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/03-SpectralMethods"
                >
                  
                  03-SpectralMethods
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/04-EventRelatedPotentials"
                >
                  
                  04-EventRelatedPotentials
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/05-FrequencyInteractions"
                >
                  
                  05-FrequencyInteractions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/tutorials/06-ColoredNoise"
                >
                  
                  06-ColoredNoise
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/07-CommonMisinterpretations"
                >
                  
                  07-CommonMisinterpretations
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/08-FrequencyMisinterpretations"
                >
                  
                  08-FrequencyMisinterpretations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          <!-- INTERACT LINKS -->

    
    
    <div class="buttons">
        <a class="interact-button" href="https://mybinder.org/v2/gh/choldgraf/jupyter-book/master?filepath=content%2Ftutorials%2F06-ColoredNoise.ipynb">Interact</a>
    </div>


          <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#white-noise---time-domain">White Noise - Time Domain</a></li>
  <li><a href="#white-noise---frequency-domain">White Noise - Frequency Domain</a></li>
  <li><a href="#pink-noise---time-domain">Pink Noise - Time Domain</a></li>
  <li><a href="#pink-noise---frequency-domain">Pink Noise - Frequency Domain</a></li>
  <li><a href="#brown-noise---time-domain">Brown Noise - Time Domain</a></li>
  <li><a href="#brown-noise---frequency-domain">Brown Noise - Frequency Domain</a></li>
</ul>
    </nav>
  </aside>


          <h1 id="colored-noise">Colored Noise</h1>

<p>In this notebook we are going to discuss various colored noise, such as white noise, in the time and frequency domain and how they relate to brain oscillations.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">utils.noise</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>

<p>General noise is a signal that is largely formed through a <a href="https://en.wikipedia.org/wiki/Stochastic">stochasitc process</a>. When we talk about colored noise we usually refer to an additional underlying pattern that is evident in the signal eventhough there is some amount of randomness involved.
Some types of colored noise follow the general form of <script type="math/tex">\frac{1}{f^{\beta}}</script> where β determines the ‘color’ and properties of the noise. These are the types of noise we will be discussing in this notebook which we will call ‘power law noises’.</p>

<h3 id="white-noise---time-domain">White Noise - Time Domain</h3>

<p>White noise is an example of a power law noise where β = 0. Below is a time series of white noise. This noise is generated by sampling from a normal distribution and as a result we see the y values mirror the normal distribution - there are many samples close to 0 and fewer samples further away from 0. White noise can also be generated from other distributions such as unifom and poisson distributions which affect the range of the samples.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">white_data</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">white_noise_time</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_5_0.png" alt="png" /></p>

<h3 id="white-noise---frequency-domain">White Noise - Frequency Domain</h3>

<p>If we compute a fourier transfrom on our white noise time series signal we will arrive at the frequency domain of our signal. The main characteristic of white noise is that the frequency spectrum is flat - this is where the Power law relationship of 1/f^0 comes from. The total power in any two frequency bands of equal width is the same. For example, the total power from [20, 50] Hz is the same as the total power in [350, 380] Hz because the bandwidths are both the same. For those interested, here’s <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers">why.</a></p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">white_noise_frequency</span><span class="p">(</span><span class="n">white_data</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_7_0.png" alt="png" /></p>

<p>Here is a plot to show the power at every frequency. Notice that the trend is a line parallel to the x-axis. This is a result of β = 0.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">white_welch</span><span class="p">(</span><span class="n">white_data</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_9_0.png" alt="png" /></p>

<h3 id="pink-noise---time-domain">Pink Noise - Time Domain</h3>

<p>Pink noise is our next power law noise which has a β value of β = 1. The time series seems more sporadic than the white noise time series but the pink noise PSD has some interesting features. This is the first noise whose power spectrum resembles a signal found in the brain. The following is an algorithm created by Voss and McCarthy to generate pink noise.</p>

<p>Voss, R. F., &amp; Clarke, J. (1978). “1/f noise” in music: Music from 1/f noise”. Journal of the Acoustical Society of America 63: 258–263.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pink_data</span><span class="p">,</span><span class="n">fs</span> <span class="o">=</span> <span class="n">pink_noise_time</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_11_0.png" alt="png" /></p>

<h3 id="pink-noise---frequency-domain">Pink Noise - Frequency Domain</h3>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pink_noise_frequency</span><span class="p">(</span><span class="n">pink_data</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_13_0.png" alt="png" /></p>

<p>Notice that in linear space plot (up on left) plots the data in a hard-to-digest way. As a result, pink noise is often shown in log space - the y-axis is scaled such that each subsequent value is 10x larger than the previous. It turns out that this distribution $\frac{1}{f^{1}}$ mysteriously shows up quite a lot in the <a href="https://www.youtube.com/watch?v=fCn8zs912OE">universe.</a></p>

<p>When we see the distriution of power in each frequency notice that there is a downward slope. This figure is in log-log space which means that both axes have a logrithmic scaling. Again, this is a result of β = 1. Colloquially, we say that β represents the slope because as β increses, the slope of the welch plot gets steeper. This only makes sense when the scaling in in log-log though.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pink_welch</span><span class="p">(</span><span class="n">pink_data</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_16_0.png" alt="png" /></p>

<h3 id="brown-noise---time-domain">Brown Noise - Time Domain</h3>

<p>The last colored noise we will go over is Brown noise which has β = 2. Brown noise, also known as red noise, looks similar to pink noise in both the time domain and frequency domain but with some exaggerated features - the time series is even more sporadic.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brown_data</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">brown_noise_time</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_19_0.png" alt="png" /></p>

<h3 id="brown-noise---frequency-domain">Brown Noise - Frequency Domain</h3>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brown_noise_frequency</span><span class="p">(</span><span class="n">brown_data</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_21_0.png" alt="png" /></p>

<p>Notice that in linear space the power spectrum is slightly harder to digest than the pink noise counterpart. Also note that the slope of the power spectrum is slightly steeper than that of pink noise. These patterns will be more exaggerated as β takes on larger values.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brown_welch</span><span class="p">(</span><span class="n">brown_data</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../images/build/tutorials/06-ColoredNoise_23_0.png" alt="png" /></p>

<p>Compare this distribution to that of pink noise. Notice the scaling to see how the β value affects slope in this log-log plot.</p>


          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/tutorials/05-FrequencyInteractions">
      〈 <span class="u-margin-right-tiny"></span> 05-FrequencyInteractions
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/tutorials/07-CommonMisinterpretations">
      07-CommonMisinterpretations <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

        </div>
      </main>
    </div>

  </body>
</html>
