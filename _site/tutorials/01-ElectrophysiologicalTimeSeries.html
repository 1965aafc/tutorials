<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>01-ElectrophysiologicalTimeSeries</title>
  <meta name="description" content="Electrophysiological Time-Series">

  <link rel="canonical" href="http://localhost:4000//tutorials/01-ElectrophysiologicalTimeSeries.html">
  <link rel="alternate" type="application/rss+xml" title="VoytekLab Tutorials" href="http://localhost:4000//feed.xml">

  <meta property="og:url"         content="http://localhost:4000//tutorials/01-ElectrophysiologicalTimeSeries.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="01-ElectrophysiologicalTimeSeries" />
<meta property="og:description" content="Electrophysiological Time-Series" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://localhost:4000//tutorials/01-ElectrophysiologicalTimeSeries.html",
  "headline":
    "01-ElectrophysiologicalTimeSeries",
  "datePublished":
    "2018-10-26T23:55:44-07:00",
  "dateModified":
    "2018-10-26T23:55:44-07:00",
  "description":
    "Electrophysiological Time-Series",
  "author": {
    "@type": "Person",
    "name": "VoytekLab"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4000/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://localhost:4000/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  console.log(url)
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return jQuery.param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = $("a").each(function() {
    var href = this.href;
    // If the link is an internal link...
    if (href.search("http://localhost:4000") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + jQuery.param(params);
      this.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = $("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = 'binder';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("https://mybinder.org", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          $("a.interact-button").after($('<div class="interact-context">on ' + hubUrlNoHttp + '</div>'));

      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">VoytekLab Tutorials</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/tutorials/00-Introduction"
        >
          
          Tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/00-Introduction"
                >
                  
                  00-Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/tutorials/01-ElectrophysiologicalTimeSeries"
                >
                  
                  01-ElectrophysiologicalTimeSeries
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/02-Filtering"
                >
                  
                  02-Filtering
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/03-SpectralMethods"
                >
                  
                  03-SpectralMethods
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/04-EventRelatedPotentials"
                >
                  
                  04-EventRelatedPotentials
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/05-FrequencyInteractions"
                >
                  
                  05-FrequencyInteractions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/06-ColoredNoise"
                >
                  
                  06-ColoredNoise
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/07-CommonMisinterpretations"
                >
                  
                  07-CommonMisinterpretations
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/tutorials/08-FrequencyMisinterpretations"
                >
                  
                  08-FrequencyMisinterpretations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          <!-- INTERACT LINKS -->

    
    
    <div class="buttons">
        <a class="interact-button" href="https://mybinder.org/v2/gh/choldgraf/jupyter-book/master?filepath=content%2Ftutorials%2F01-ElectrophysiologicalTimeSeries.ipynb">Interact</a>
    </div>


          <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#default-imports">Default Imports</a></li>
  <li><a href="#loading-data-with-npy-file">Loading data with npy file</a></li>
  <li><a href="#sampling--aliasing">Sampling &amp; Aliasing</a></li>
  <li><a href="#generate-time-axis">Generate time axis</a></li>
  <li><a href="#1-plot-the-time-series">1. Plot the time series</a></li>
</ul>
    </nav>
  </aside>


          <h1 id="electrophysiological-time-series">Electrophysiological Time-Series</h1>

<p>Welcome to the Voytek Lab GitHub and Jupyter notebook collection. This is the second Jupyter notebook of a tutorial series aiming to get those interested in doing meaningful work in Voytek lab up to speed. We use this tool to learn how to load our data and graph it.</p>

<p>The purpose of this notebook is to:</p>
<ul>
  <li>Learn how to load data with a npy file</li>
  <li>Learn the purpose of Sampling and Aliasing</li>
  <li>Generate a time axis and plot the time series as a graph</li>
  <li>Learn (generally) what our generated graph shows</li>
  <li>Learn about different wave types and burstiness</li>
  <li>Introduce you to reference nodes</li>
</ul>

<h3 id="default-imports">Default Imports</h3>

<p>First, we will import some basic python libraries that contain functions in order to do this tutorial.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'white'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="part-1-loading-sampling-generating-a-time-axis-analyzing">Part 1: Loading, Sampling, Generating a time axis, Analyzing</h2>

<h3 id="loading-data-with-npy-file">Loading data with npy file</h3>

<p>We will now load in our data which is a voltage series.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">volt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">'./exampledata.npy'</span><span class="p">)</span> <span class="c"># voltage series</span>
</code></pre></div></div>

<h3 id="sampling--aliasing">Sampling &amp; Aliasing</h3>

<p>In order to generate our time axis, we must set a sampling rate. What does this mean you might ask? Jack Schaedler at <a href="https://jackschaedler.github.io/circles-sines-signals/aliasing.html">his interactive tutorial page</a> does an excellent job of explaining this under “Sampling &amp; Aliasing”, so read up and return!</p>

<hr />

<p>To go further in depth, the sampling rate is important for how we analyze data in the frequency domain. When you digitally record a signal, you measure it at a certain rate by taking samples x times per second (quantified in Hertz). For this reason, we don’t know the exact amplitude of any digital signal at every single point in time. Our best guess is the closest sample to a given point in time.</p>

<p>Resampling, PSD, and many other things we do in this lab fall under the title of Digital Signal Processing. You can read more about it for free <a href="http://dspguide.com/">here</a></p>

<h5 id="so-why-should-we-sample">So why should we Sample?</h5>

<p>We sample because there is a cost to data which is memory. If we have a faster sampling rate, we can have better temporal resolution but storing excessive samples can make the file size too big and use too much memory. Sometimes you will have extremely large data sets that simply take too much memory so we take sample rates to divide that space usage. It is possible to oversample which means that we have more samples than necessary which would make our files unneccesarily large, but there is also undersampling which is when we lose information by not sampling enough, but in return we can make our files smaller. The sample rate is something that we must choose carefully as there is a trade off for both sides.</p>

<hr />
<p>If you would like further information on how to choose a good sampling rate, take a look at Schaedler’s interactive site https://jackschaedler.github.io/circles-sines-signals/sampling.html under “The Sampling Theorem”</p>

<p>To show how sampling can go wrong if we jump to conclusions, take a look at figure 1 shown below.</p>

<p>We have four different 2 hour flights from Paris to Berlin with a sample rate of 10 minutes. We should take care not to “connect the dots” as we can see that figure 1 has the same sample rates for four different flights which all create the same graph (shown in grey). We can see here, however, that they are drastically different altitude patterns when we see the overall flight altitudes of each flight.</p>

<p><img src="img/image1.png" alt="image1.png" />
from <a href="https://jackschaedler.github.io/circles-sines-signals/aliasing.html">Jack Schaedler</a></p>

<h3 id="generate-time-axis">Generate time axis</h3>

<p>Now, we will generate our time axis. We will set our sampling rate to be 1000 in this example case.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rate</span> <span class="o">=</span> <span class="mf">1000.</span> <span class="c"># sampling rate</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">volt</span><span class="p">)</span><span class="o">/</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">rate</span><span class="p">)</span> <span class="c">#time series</span>
</code></pre></div></div>

<h3 id="1-plot-the-time-series">1. Plot the time series</h3>

<p>We have our time series and now we will visualize it by graphing it.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">time_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">]</span> <span class="c"># time range you want to plot</span>
<span class="n">time_plot_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">time</span><span class="o">&gt;=</span><span class="n">time_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="n">time_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_plot_idx</span><span class="p">],</span> <span class="n">volt</span><span class="p">[</span><span class="n">time_plot_idx</span><span class="p">],</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time (s)'</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Voltage (uV)'</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">time_plot</span><span class="p">))</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(9, 10.5)
</code></pre></div></div>

<p><img src="../images/build/tutorials/01-ElectrophysiologicalTimeSeries_18_1.png" alt="png" /></p>

<h5 id="analyzing-our-graph">Analyzing our graph</h5>
<p>Neural data has rythmic patterns that are variable as well as other patterns that are “bursty” i.e non continuous shown above. Our graph also has 8 peaks in half a second which is equal to 16 Hz, making this a Beta wave.</p>

<p>Different neural oscillatory patterns have different ranges and the general ranges are shown below.</p>

<p><img src="img/image2.jpg" alt="image2.jpg" />
from <a href="http://www.mindbodyvortex.com/wp-content/uploads/2015/09/f3a6b3eb4cc6f2d7392b34284c233281.jpg">mindbodyvortex</a></p>

<h2 id="part-2--ground-vs-referencing">Part 2:  Ground vs. Referencing</h2>

<p>To learn more about ground vs. reference for EEG recordings, we can visit</p>
<ol>
  <li>https://www.biopac.com/knowledge-base/ground-vs-reference-for-eeg-recording/</li>
  <li>(https://www.researchgate.net/post/What_is_the_difference_between_ground_and_reference_electrode_in_EEG_recording)</li>
</ol>

<p>To summarize,</p>

<p>An EEG (electroencephalogram)is the potential difference between an active electrode and a reference electrode.
Voltage signals are always relative. You can have different references.</p>

<p>The ground electrode is used to reduce artifacts (electrical circuit, mouvement…), preventing noise from interfering with the signals of interest.</p>

<p>Referencing is when you have an electrode you use to measure the electrical difference between the active electrode and itself.</p>

<p>“The reference lead is the lead that connects the reference electrode; in EEG recordings, this electrode is usually placed at the ear or, in the case of “summed ears,” to a pair of electrodes, one at each ear. The measured electrical potential differences are ideally the voltage drops from the active electrode to the reference electrode.</p>

<h2 id="part-3-neural-oscillations">Part 3: Neural Oscillations</h2>

<h1 id="under-construction">UNDER CONSTRUCTION</h1>


          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/tutorials/00-Introduction">
      〈 <span class="u-margin-right-tiny"></span> 00-Introduction
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/tutorials/02-Filtering">
      02-Filtering <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

        </div>
      </main>
    </div>

  </body>
</html>
